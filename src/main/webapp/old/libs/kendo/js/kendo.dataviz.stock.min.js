/*
* Kendo UI Complete v2012.3.1315 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
(function(t){var e=window.kendo,i=e.Class,a=e.Observable,o=e.deepExtend,n=Math,s=t.proxy,r=e.dataviz,l=e.template,c=r.defined,d=r.ui.Chart,p=r.Selection,u=r.addDuration,f=r.duration,h=r.last,m=r.lteDateIndex,v=r.renderTemplate,g=r.toDate,x=r.toTime,b=28,_="change",S="k-",w="drag",y="dragEnd",A="_navigator",D=A,T="selectStart",C="select",U="selectEnd",E=3,k="zoom",B="zoomEnd",j=d.extend({init:function(t,e){var i=this;d.fn.init.call(i,t,e)},_applyDefaults:function(t,e){var i=this,a=i.element.width()||r.DEFAULT_WIDTH,s={axisDefaults:{categoryAxis:{name:"default",field:t.dateField,majorGridLines:{visible:!1},labels:{step:2},majorTicks:{visible:!1},maxDateGroups:n.floor(a/b)}}};e&&(e=o({},e,s)),i._navigator||F.setup(t,e),d.fn._applyDefaults.call(i,t,e)},_initDataSource:function(t){var e,i,a=t||{},n=a.dataSource,s=n&&n.serverFiltering,l=[].concat(a.categoryAxis)[0],c=a.navigator||{},p=c.select,u=p&&p.from&&p.to;s&&u&&(e=[].concat(n.filter||[]),i=new r.DateCategoryAxis(o({baseUnit:"fit"},l,{categories:[p.from,p.to]})),n.filter=F.buildFilter(i.options.min,p.to).concat(e)),d.fn._initDataSource.call(this,t)},options:{name:"StockChart",dateField:"date",axisDefaults:{categoryAxis:{type:"date",baseUnit:"fit",justified:!0},valueAxis:{narrowRange:!0,labels:{format:"C"}}},navigator:{select:{},seriesDefaults:{markers:{visible:!1},tooltip:{visible:!0,template:"#= kendo.toString(category, 'd') #"},line:{width:2}},hint:{},visible:!0},tooltip:{visible:!0},legend:{visible:!1}},_redraw:function(){var t=this,e=t._navigator;e&&e.dataSource?e.redrawSlaves():(e||(e=t._navigator=new F(t)),e.filterAxes(),d.fn._redraw.call(t),e.redraw())},_onDataChanged:function(){var t=this;d.fn._onDataChanged.call(t),t._dataBound=!0},destroy:function(){var t=this;t._navigator.destroy(),d.fn.destroy.call(t)}}),F=a.extend({init:function(t){var e=this;e.chart=t,e.options=o({},e.options,t.options.navigator),e._initDataSource(),c(e.options.hint.visible)||(e.options.hint.visible=e.options.visible),t.bind(w,s(e._drag,e)),t.bind(y,s(e._dragEnd,e)),t.bind(k,s(e._zoom,e)),t.bind(B,s(e._zoomEnd,e))},options:{},_initDataSource:function(){var t=this,i=t.options,a=i.autoBind,o=i.dataSource;c(a)||(a=t.chart.options.autoBind),t._dataChangedHandler=s(t._onDataChanged,t),o&&(t.dataSource=e.data.DataSource.create(o).bind(_,t._dataChangedHandler),a&&t.dataSource.fetch())},_onDataChanged:function(){var t,e,i,a,o=this,n=o.chart,s=n.options.series,r=s.length,l=n.options.categoryAxis,c=l.length,d=o.dataSource.view();for(t=0;r>t;t++)i=s[t],i.axis==D&&n.isBindable(i)&&(i.data=d);for(e=0;c>e;e++)a=l[e],a.pane==A&&n._bindCategoryAxis(a,d);n._model&&(o.redraw(),o.filterAxes(),(!n.options.dataSource||n.options.dataSource&&n._dataBound)&&o.redrawSlaves())},destroy:function(){var t=this,e=t.dataSource;e&&e.unbind(_,t._dataChangeHandler),t.selection&&t.selection.destroy()},redraw:function(){this._redrawSelf();var e=this,i=e.chart,a=e.options,o=e.mainAxis(),n=o.options.categories,s=e.options.select||{},l=e.selection,c=0,d=n.length-1,u=c,f=d;n.length>0&&(s.from&&(u=m(n,g(s.from))),s.to&&(f=m(n,g(s.to))),l&&(l.destroy(),l.wrapper.remove()),l=e.selection=new p(i,o,{min:c,max:d,from:u,to:f,selectStart:t.proxy(e._selectStart,e),select:t.proxy(e._select,e),selectEnd:t.proxy(e._selectEnd,e),visible:a.visible}),a.hint.visible&&(e.hint=new z(i.element,{min:n[0],max:r.last(n),template:a.hint.template,format:a.hint.format})))},_redrawSelf:function(t){var e=this.chart._plotArea;e&&e.redraw(h(e.panes),t)},redrawSlaves:function(){var t=this,e=t.chart,i=e._plotArea,a=i.panes.slice(0,-1);e._plotArea.redraw(a)},_drag:function(t){var e,i,a=this,o=a.chart,s=o._eventCoordinates(t.originalEvent),l=a.mainAxis(),c=l.pane.box.containsPoint(s),d=l.options.categories,p=o._plotArea.categoryAxis,h=p.options.baseUnit,v=t.axisRanges[p.options.name],x=a.selection,b=f(p.options.min,p.options.max,p.options.baseUnit);v&&!c&&(e=g(n.min(n.max(d[0],v.min),u(r.last(d),-b,h))),i=g(n.min(u(e,b,h),r.last(d))),a.options.select={from:e,to:i},a._liveDrag()&&(a.filterAxes(),a.redrawSlaves()),x.set(m(d,e),m(d,i)+1),a.showHint(e,i))},_dragEnd:function(){var t=this;t.filterAxes(),t.filterDataSource(),t.redrawSlaves(),t.hint&&t.hint.hide()},_liveDrag:function(){var t=e.support,i=t.touch,a=t.browser,o=a.mozilla,n=a.msie&&9>a.version;return!i&&!o&&!n},readSelection:function(){var t=this,e=t.mainAxis(),i=e.options.categories,a=t.selection,o=a.options,n=t.options.select;n.from=i[o.from],n.to=i[o.to]},indexToDate:function(t){var e=this,i=e.mainAxis(),a=i.options.categories;return a[t]},filterAxes:function(){var t,e,i,a,o,n=this,s=n.options.select||{},r=n.chart,l=r.options.categoryAxis,c=s.from,d=s.to;for(a=0;l.length>a;a++)if(o=l[a],o.name===D&&(t=o.categories,t&&t.length>0)){e=x(t[0]),i=x(h(t)),c=x(c),(e>c||c>i)&&(c=e),d=x(d),(e>d||d>i)&&(d=i);break}for(a=0;l.length>a;a++)o=l[a],o.pane!==A&&(o.min=g(c),o.max=g(d))},filterDataSource:function(){var t,e=this,i=e.options.select||{},a=e.chart,n=a.dataSource,s=n&&n.options.serverFiltering;e.dataSource&&s&&(t=new r.DateCategoryAxis(o({baseUnit:"fit"},a.options.categoryAxis[0],{categories:[i.from,i.to]})).options,n.filter(F.buildFilter(u(t.min,-t.baseUnitStep,t.baseUnit),u(t.max,t.baseUnitStep,t.baseUnit))))},_zoom:function(t){var i=this,a=i.chart,o=t.delta,s=i.mainAxis(),r=a._plotArea.categoryAxis,l=i.options.select,c=i.selection;t.originalEvent.preventDefault(),n.abs(o)>1&&(o*=E),c.options.to-c.options.from>1?(c.expandLeft(o),i.readSelection()):(r.options.min=l.from,l.from=r.scaleRange(-t.delta).min),e.support.touch||(i.filterAxes(),i.redrawSlaves()),c.set(m(s.options.categories,i.options.select.from),m(s.options.categories,i.options.select.to)),i.showHint(i.options.select.from,i.options.select.to)},_zoomEnd:function(t){this._dragEnd(t)},showHint:function(t,e){var i=this,a=i.chart,o=a._plotArea;i.hint&&i.hint.show(t,e,o.backgroundBox())},_selectStart:function(t){this.chart.trigger(T,{from:t.from,to:t.to})&&t.preventDefault()},_select:function(t){var e=this;e.showHint(e.indexToDate(t.from),e.indexToDate(t.to)),e.chart.trigger(C,{from:t.from,to:t.to})},_selectEnd:function(t){var e=this;e.hint&&e.hint.hide(),e.readSelection(),e.filterAxes(),e.filterDataSource(),e.redrawSlaves(),e.chart.trigger(U,{from:t.from,to:t.to})},mainAxis:function(){var t=this.chart._plotArea;return t?t.namedCategoryAxes[D]:undefined}});F.setup=function(t,e){t=t||{},e=e||{};var i=o({},e.navigator,t.navigator),a=t.panes=[].concat(t.panes),n=o({},i.pane,{name:A});i.visible||(n.visible=!1,n.height=.1),a.push(n),F.attachAxes(t,i),F.attachSeries(t,i,e)},F.attachAxes=function(t,e){var i,a;i=t.categoryAxis=[].concat(t.categoryAxis),a=t.valueAxis=[].concat(t.valueAxis);var n=o({type:"date",pane:A,field:e.dateField,roundToBaseUnit:!1,justified:!0,tooltip:{visible:!1},labels:{step:1},autoBind:!e.dataSource,autoBaseUnitSteps:{minutes:[1],hours:[1],days:[1],weeks:[],months:[1],years:[1]},_overlap:!1},e.categoryAxis);i.push(o({},n,{name:D,baseUnit:"fit",maxDateGroups:200,baseUnitStep:"auto",labels:{visible:!1},majorTicks:{visible:!1}}),o({},n,{name:D+"_labels",maxDateGroups:20,baseUnitStep:"auto",autoBaseUnitSteps:{minutes:[]},majorTicks:{visible:!0}}),o({},n,{name:D+"_ticks",maxDateGroups:200,majorTicks:{visible:!0,width:.5},labels:{visible:!1,mirror:!0}})),a.push({name:D,pane:A,majorGridLines:{visible:!1},visible:!1})},F.attachSeries=function(t,e,i){var a,n=t.series=t.series||[],s=[].concat(e.series),r=i.seriesColors,l=e.seriesDefaults;for(a=0;s.length>a;a++)n.push(o({color:r[a%r.length],visibleInLegend:!1,tooltip:{visible:!1}},l,s[a],{axis:D,categoryAxis:D,autoBind:!e.dataSource}))},F.buildFilter=function(t,e){return[{field:"Date",operator:"gte",value:g(t)},{field:"Date",operator:"lt",value:g(e)}]};var z=i.extend({init:function(e,i){var a=this;a.options=o({},a.options,i),a.container=e,a.chartPadding={top:parseInt(e.css("paddingTop"),10),left:parseInt(e.css("paddingLeft"),10)},a.template=a.template,a.template||(a.template=a.template=v("<div class='"+S+"navigator-hint' "+"style='display: none; position: absolute; top: 1px; left: 1px;'>"+"<div class='"+S+"tooltip'>&nbsp;</div>"+"<div class='"+S+"scroll' />"+"</div>")),a.element=t(a.template()).appendTo(e)},options:{format:"{0:d} - {1:d}",hideDelay:500},show:function(t,i,a){var o,n=this,s=g(x(t)+x(i-t)/2),r=n.options,c=e.format(n.options.format,t,i),d=n.element.find("."+S+"tooltip"),p=n.element.find("."+S+"scroll"),u=.4*a.width(),f=a.center().x-u,h=a.center().x,m=h-f,v=r.max-r.min,b=m/v,_=s-r.min;n._hideTimeout&&clearTimeout(n._hideTimeout),n._visible||(n.element.stop(!1,!0).css("visibility","hidden").show(),n._visible=!0),r.template&&(o=l(r.template),c=o({from:t,to:i})),d.text(c).css({left:a.center().x-d.outerWidth()/2,top:a.y1}),p.css({width:u,left:f+_*b,top:a.y1+parseInt(d.css("margin-top"),10)+parseInt(d.css("border-top-width"),10)+d.height()/2}),n.element.css("visibility","visible")},hide:function(){var t=this;t._hideTimeout&&clearTimeout(t._hideTimeout),t._hideTimeout=setTimeout(function(){t._visible=!1,t.element.fadeOut("slow")},t.options.hideDelay)}});r.ui.plugin(j),o(r,{Navigator:F})})(window.kendo.jQuery);